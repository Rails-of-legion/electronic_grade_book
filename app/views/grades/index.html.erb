<% if Grade.exists? %>
  <% if @grades.present? %>
    <div class="container">
      <div class="row mb-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h1><%= t('grades.grades') %></h1>
          <% if current_user.has_role?(:admin) %>
            <%= link_to t('common.add'), new_grade_path, class: 'btn btn-primary' %>
          <% end %>
        </div>
      </div>

      <div class="d-flex justify-content-center">
        <div class="flex-shrink-1" style="width: 60%;">
          <table class="table table-striped mt-3">
            <thead>
              <tr>
                <th><%= t('grades.item') %></th>
                <th><%= t('grades.grade') %></th>
                <th><%= t('grades.student') %></th>
                <% if current_user.has_role?(:admin) %>
                  <th><%= t('common.actions') %></th>
                <% end %>
              </tr>
            </thead>
            <tbody>
              <% @grades.each do |grade| %>
                <tr>
                  <td><%= grade.subject.name %></td>
                  <td><%= grade.grade %></td>
                  <td><%= grade.record_book.user.last_name %> <%= grade.record_book.user.first_name %></td>
                  <% if current_user.has_role?(:admin) %>
                    <td>
                      <%= link_to t('common.show'), grade_path(grade), class: 'btn btn-sm btn-outline-primary' %>
                      <%= link_to t('common.edit'), edit_grade_path(grade), class: 'btn btn-sm btn-outline-secondary' %>
                      <%= button_to t('common.delete'), grade_path(grade), method: :delete, data: { confirm: t('notifications.you_are_sure') }, class: 'btn btn-sm btn-outline-danger' %>
                    </td>
                  <% end %>
                </tr>
              <% end %>
            </tbody>
          </table>
          <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
        </div>

        <div class="col-md-4 mt-2 ml-4">
          <%= search_form_for @q do |f| %>
            <div class="container">
              <div class="form-row">
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.label :subject_name_cont, t('grades.item') %>
                  <%= f.search_field :subject_name_cont, class: 'form-control' %>
                </div>
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.label :grade_eq, t('grades.grade') %>
                  <%= f.search_field :grade_eq, class: 'form-control' %>
                </div>
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.label :record_book_user_last_name_cont, t('grades.students_last_name') %>
                  <%= f.search_field :record_book_user_last_name_cont, class: 'form-control' %>
                </div>
              </div>
              <div class="form-row">
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.submit t('common.search'), class: 'btn btn-primary' %>
                </div>
                <div class="col-md-4 mt-4 ml-4">
                  <%= link_to t('common.reset'), grades_path, class: "btn btn-secondary" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <div class="container">
      <div class="row mb-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h1><%= t('grades.grades') %></h1>
          <% if current_user.has_role?(:admin) %>
            <%= link_to t('common.add'), new_grade_path, class: 'btn btn-primary' %>
          <% end %>
        </div>
      </div>

      <div class="d-flex justify-content-center">
        <div class="flex-shrink-1" style="width: 60%;">
          <table class="table table-striped mt-3">
            <thead>
              <tr>
                <th><%= t('grades.item') %></th>
                <th><%= t('grades.grade') %></th>
                <th><%= t('grades.student') %></th>
                <% if current_user.has_role?(:admin) %>
                  <th><%= t('common.actions') %></th>
                <% end %>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="4" class="text-center"><%= t('grades.no_grades_found') %></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-md-4 mt-2 ml-4">
          <%= search_form_for @q do |f| %>
            <div class="container">
              <div class="form-row">
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.label :subject_name_cont, t('grades.item') %>
                  <%= f.search_field :subject_name_cont, class: 'form-control' %>
                </div>
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.label :grade_eq, t('grades.grade') %>
                  <%= f.search_field :grade_eq, class: 'form-control' %>
                </div>
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.label :record_book_user_last_name_cont, t('grades.students_last_name') %>
                  <%= f.search_field :record_book_user_last_name_cont, class: 'form-control' %>
                </div>
              </div>
              <div class="form-row">
                <div class="col-md-4 mt-4 ml-4">
                  <%= f.submit t('common.search'), class: 'btn btn-primary' %>
                </div>
                <div class="col-md-4 mt-4 ml-4">
                  <%= link_to t('common.reset'), grades_path, class: "btn btn-secondary" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
<% else %>
  <div class="container mt-5">
    <div class="alert alert-warning" role="alert">
      <%= t('grades.no_grades_found') %>
    </div>
    <% if can? :create, Grade %>
      <div class="container mt-4">
        <%= link_to t('grades.new'), new_grade_path, class: "btn btn-primary", style: "width: 7cm; height: 38px;" %>
      </div>
    <% end %>
  </div>
<% end %>
