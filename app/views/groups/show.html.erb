<h1>Group Details</h1>
<p>  <b>Name:</b> <%= @group.name %></p>
<p>  <b>Curator:</b> <%= @group.try(:curator).try(:name) || 'Unassigned' %></p>

<h1>Record Books</h1>
<%= simple_form_for :grade, url: group_path(month: params[:month]), method: :get, html: { class: 'form-inline' } do |f| %>
  <%= f.input :selected_month, collection: Date::MONTHNAMES.compact.each_with_index.map { |name, i| [name, i+1] }, prompt: 'Выберите месяц', input_html: {name: 'month', class: 'form-control' } %>
  <%= f.input :subject_id, collection: @group.specialization.subjects, label_method: :name, value_method: :id, prompt: 'Выберите предмет', input_html: { name: 'subject_id', class: 'form-control', onchange: 'this.form.submit();' } %> 

  <% if params[:month] && params[:subject_id] %>
    <%= render partial: 'form_teacher' %>
  <% end %>

  <%= hidden_field_tag :year, Time.now.year %>
<% end %>


<%= simple_form_for Grade.new, url: {controller: "grades", action: "create"}, method: :post do |f| %>
<%= f.input :date, collection: (1..Time.days_in_month(@month.to_i)), prompt: 'Выберите день', input_html: { class: 'form-control' } %>
<%= f.input :grade, collection: (1..5), prompt: 'Добавить оценку', input_html: { class: 'form-control' } %>

<%= f.input :record_book_id, collection: RecordBook.where(specialization_id: @group.specialization.id, group_id: @group.id).map { |record_book| [record_book.user.name, record_book.id] }, prompt: 'Выберите студента', input_html: { class: 'form-control' } %>

<%= hidden_field_tag :month, @month %>
<%= hidden_field_tag :year, Time.now.year %>
<%= f.hidden_field :subject_id, value: params[:subject_id] %>
<%= f.button :submit, 'Добавить оценку', class: 'btn btn-primary' %>
<% end %> 

<%= link_to "Edit", edit_group_path(@group), class: "btn btn-primary" %>
<%= link_to "Back", groups_path, class: "btn btn-secondary" %>