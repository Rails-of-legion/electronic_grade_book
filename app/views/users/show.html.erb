<% if current_user == @user %>
  <h1 class="display-4 text-center mb-4">Personal Profile</h1>
<% end %>
<div class="container">  
  <div class="card">
    <div class="card-body">
      <h2 class="card-title"><%= @user.name %></h2>   
      <div class="row">    
        <div class="col-sm-9">      
          <ul class="list-group list-group-flush">        
            <li class="list-group-item"><strong>Email:</strong> <%= @user.email %></li>                
            <% if @user.has_role?(:student) && @user.record_book.present? %>        
              <li class="list-group-item"><strong>Specialization</strong> <%= @user.record_book.specialization.name %></li>
              <li class="list-group-item"><strong>Group:</strong> <%= @user.record_book.group.name %></li>
              <li class="list-group-item"><%= link_to "Зачетная книжка", @user.record_book %></li>  
            <% end %>        
            <li class="list-group-item"><strong>Status:</strong> <%= @user.status %></li>
            <li class="list-group-item"><strong>Date of birth:</strong> <%= @user.date_of_birth %></li>      
          </ul>    
        </div>  
      </div>
      <div>
      </div>  
      <% if current_user == @user %>
      <div class="mt-3">
        <button class="btn btn-primary" data-bs-toggle="collapse" data-bs-target="#notifications">
          Показать уведомления
        </button>
        <%= link_to "Изменить пароль", edit_password_path(@user), class: "btn btn-primary" %>
        <%= link_to "Изменить Email", edit_email_path(@user), class: "btn btn-secondary" %>
      </div>
      <div class="collapse" id="notifications">
        <div class="card card-body">
          <% if @notificationsUser.any? { |notification| notification.status == false } %>
            <ul class="list-group">
              <% @notificationsUser.each do |notification| %>
                <% if notification.status == false %>
                  <li class="list-group-item">
                    <%= Notification.find(notification.notification_id).message %>
                    <%= button_to 'Ознакомлен', mark_as_read_notification_path(notification), method: :patch, class: "btn btn-link" %>
                  </li>
                <% end %>
              <% end %>
            </ul>
          <% else %>
            <p>У вас нет новых уведомлений</p>
          <% end %>
    
          <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#readNotifications">
            Прочитанные уведомления
          </button>
          <div class="collapse" id="readNotifications">
            <ul class="list-group">
              <% @notificationsUser.each do |notification| %>
                <% if notification.status == true %>
                  <li class="list-group-item">
                    <%= Notification.find(notification.notification_id).message %>
                  </li>
                <% end %>
              <% end %>
            </ul>
          </div>
        </div>
      </div>
    <% end %>