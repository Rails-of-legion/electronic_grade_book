<div class="container">
  <div class="row mb-4">
    <div class="col-md-6">
      <h1><%= t('users.users') %></h1>
    </div>
  </div>

  <div class="row mb-4">
    <div class="col-md-9">
      <% if @users.present? %>
        <table class="table table-striped">
          <thead>
            <tr>
              <th><%= t('users.last_name') %></th>
              <th><%= t('users.first_name') %></th>
              <th><%= t('users.middle_name') %></th>
              <th><%= t('users.email') %></th>
              <th><%= t('users.phone_number') %></th>
              <th><%= t('users.role') %></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% @users.each do |user| %>
              <tr>
                <td><%= user.first_name %></td>
                <td><%= user.last_name %></td>
                <td><%= user.middle_name %></td>
                <td><%= user.email.gsub('@', '<br />@')&.html_safe %></td> 
                <td><%= user.phone_number %></td>
                <td><%= user.roles.map(&:name).join(', ') %></td> 
                <td class="text-right">
                  <div class="btn-group d-flex justify-content-center align-items-center" role="group">
                    <%= link_to t('common.show'), user_path(user), class: 'btn btn-primary btn-sm' %>
                    <% if current_user.has_role?(:admin) %>
                      <%= link_to t('common.edit'), edit_user_path(user), class: 'btn btn-secondary btn-sm' %>
                      <%= link_to t('common.delete'), user_path(user), method: :delete, data: { confirm: t('notifications.you_are_sure') }, class: 'btn btn-danger btn-sm' %>
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
        <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
      <% else %>
        <p class="alert alert-info"><%= t('users.no_users_found') %></p>
      <% end %>
    </div>
    <div class="col-md-3">
      <%= search_form_for @q, class: "form-inline" do |f| %>
        <div class="form-group mb-2">
          <%= f.label :last_name_cont, t('users.last_name') %>
          <%= f.search_field :last_name_cont, class: "form-control" %>
        </div>
        <div class="form-group mb-2">
          <%= f.label :first_name_cont, t('users.first_name') %>
          <%= f.search_field :first_name_cont, class: "form-control" %>
        </div>
        <div class="form-group mb-2">
          <%= f.label :middle_name_cont, t('users.middle_name') %>
          <%= f.search_field :middle_name_cont, class: "form-control" %>
        </div>
        <div class="form-group mb-2">
          <%= f.label :email_cont,  t('users.email') %>
          <%= f.search_field :email_cont, class: "form-control" %>
        </div>
        <div class="form-group mb-2">
          <%= f.label :phone_number_cont,  t('users.phone_number') %>
          <%= f.search_field :phone_number_cont, class: "form-control" %>
        </div>
        <div class="form-group mt-3">
          <%= f.submit  t('common.search'), class: 'btn btn-primary' %>
          <%= link_to t('common.reset'), users_path, class: 'btn btn-secondary' %>
        </div>
      <% end %>
    </div>
  </div>
</div>
